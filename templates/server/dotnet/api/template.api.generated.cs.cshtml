@{
    string namespaceName = @Model.Namespace; 
    string domainObj = @Model.DomainObj; 
    string domainVar = @Model.DomainVar; 
    string domainObjView = @Model.DomainObjView; 
}

using Microsoft.AspNetCore.Mvc;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using @(namespaceName);

namespace @(namespaceName).Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public partial class @(domainObj)Controller : ControllerBase
    {
        /// <summary>
        /// Retrieves all domain objects as a list of view objects.
        /// </summary>
        /// <returns>An enumerable collection of <see cref="@(domainObjView)"/> representing all domain objects.</returns>
        [HttpGet]
        public IEnumerable<@(domainObjView)> Get()
        {
            //Console.WriteLine("Processing GET List");

            List<@(domainObjView)> @(domainVar)s = @(domainObj)Logic.Create().select<@(domainObjView)>();

            return @(domainVar)s;
        }

        /// <summary>
        /// Retrieves a single domain object by id.
        /// </summary>
        /// <param name="id">The id of the domain object to retrieve.</param>
        /// <returns>The <see cref="@(domainObj)"/> instance with the specified id, or null if not found.</returns>
        [HttpGet("{id}")]
        public @(domainObj) Get(long id)
        {
            //Console.WriteLine($"Processing @(domainObj) GET ID={id}");

            @(domainObj) @(domainVar) = @(domainObj)Logic.Create().get(id);

            return @(domainVar);
        }

        /// <summary>
        /// Retrieves a view representation of a domain object by id.
        /// </summary>
        /// <param name="id">The id of the domain object to retrieve the view for.</param>
        /// <returns>A <see cref="@(domainObj)View"/> instance, or null if not found.</returns>
        [HttpGet("view/{id}")]
        public @(domainObj)View View(long id)
        {
            //Console.WriteLine($"Processing @(domainObj) View ID={id}");

            @(domainObj)View @(domainVar)View = @(domainObj)Logic.Create().view(id);

            return @(domainVar)View;
        }

     

        /// <summary>
        /// Retrieves all domain objects as enum helper objects containing id and display string.
        /// </summary>
        /// <returns>An enumerable collection of <see cref="EnumHelper"/> objects for enumeration purposes.</returns>
        [HttpGet("enum")]
        public IEnumerable<EnumHelper> GetEnum()
        {
            //Console.WriteLine("Processing GET Enum");

            List<@(domainObj)> @(domainVar)s = @(domainObj)Logic.Create().select<@(domainObj)>();

            return @(domainVar)s.Select(@(domainVar) => new EnumHelper(@(domainVar).id, @(domainVar).getRwkString()));
        }
       

      
        /// <summary>
        /// Creates a new domain object from the provided view object.
        /// </summary>
        /// <param name="@(domainVar)View">The view object containing the data for the new domain object.</param>
        /// <returns>The created <see cref="@(domainObj)View"/> with the assigned id.</returns>
        [HttpPost]
        public @(domainObj)View Post([FromBody] @(domainObj)View @(domainVar)View)
        {
            //Console.WriteLine($"Processing @(domainObj) POST: {@(domainVar)}");
            
            JsonHelper.ProcessJsonElements(@(domainVar)View);
            
            // Process any JsonElement values to ensure proper type conversion
            @(domainObj) @(domainVar) = new @(domainObj)(@(domainVar)View);

            
            
            @(domainObj)Logic.Create().put(@(domainVar)); 

            @(domainVar)View.id = @(domainVar).id;

            return @(domainVar)View;
        }

        /// <summary>
        /// Updates an existing domain object by id.
        /// </summary>
        /// <param name="id">The id of the domain object to update.</param>
        /// <param name="@(domainVar)View">The view object containing the updated data.</param>
        /// <returns>The updated <see cref="@(domainObj)View"/>.</returns>
        [HttpPut("{id}")]
        public @(domainObj)View Put(long id, [FromBody] @(domainObj)View @(domainVar)View)
        {
            //Console.WriteLine($"Processing @(domainObj) PUT: ID = {id}\n{@(domainVar)}");
            
            // Process any JsonElement values to ensure proper type conversion
            JsonHelper.ProcessJsonElements(@(domainVar)View);
            
            @(domainObj) @(domainVar) = new @(domainObj)(@(domainVar)View);

            @(domainObj)Logic.Create().update(id, @(domainVar));

            @(domainVar)View.id = @(domainVar).id;

            return @(domainVar)View;
        }

        /// <summary>
        /// Deletes a domain object by id (soft delete).
        /// </summary>
        /// <param name="id">The id of the domain object to delete.</param>
        [HttpDelete("{id}")]
        public void Delete(long id)
        {
            @(domainObj)Logic.Create().delete(id);
        }
         
        /// <summary>
        /// Retrieves the history records for a domain object by id.
        /// </summary>
        /// <param name="id">The id of the domain object to retrieve history for.</param>
        /// <returns>An enumerable collection of <see cref="@(domainObj)History"/> entries.</returns>
        [HttpGet("{id}/history")]
        public IEnumerable<@(domainObj)History> GetHistory(long id)
        {
            //Console.WriteLine($"Processing GET History for ID={id}");

            List<@(domainObj)History> historyList = @(domainObj)Logic.Create().history(id);

            return historyList;
        }
            

@{
    // Get all child relationships
    var children = Model.Children;
    
    if (children.Count > 0)
    {
        foreach(var child in children)
        {
            var childObject = child.Object;
            var childRole = child.Role;
            var childLabel = child.Label;
            var childDomainObj = childObject.DomainObj;
            var childDomainVar = childObject.DomainVar;
            var childDomainObjView = childDomainObj + "View";
            
        <text>
       // Retrieves child records for a given domain object id and child role.
        [HttpGet("{id}/@(childDomainVar)_@(childRole)")]
        public IEnumerable<@(childDomainObjView)> Get@(childDomainVar)_@(childRole)(long id)
        {
            //Console.WriteLine($"Processing GET @(childLabel) for @(domainObj) ID={id}");

            List<@(childDomainObjView)> @(childDomainVar)s = @(domainObj)Logic.Create().children<@(childDomainObjView)>(id, "@(childDomainVar)-@(childRole)");

            return @(childDomainVar)s;
        }
        </text>
        }
       
    }
       
}
    }
}
