@{
    string namespaceName = @Model.Namespace; 
    string domainObj = @Model.DomainObj;      
    string domainVar = @Model.DomainVar;    
    string schemaName = @Model.SchemaName;  
    string tableName = @Model.TableName;    
}

using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Reflection;
using @namespaceName;

namespace @namespaceName
{


    public partial class @(domainObj)Logic : I@(domainObj)Logic
    {

        /// <summary>
        /// Creates and initializes a proxy instance of the logic implementation for the domain object.
        /// </summary>
        /// <returns>An initialized proxy implementing <see cref="I@(domainObj)Logic"/>.</returns>
        public static I@(domainObj)Logic Create()
        {
            var @(domainVar) = new @(domainObj)Logic();

            var proxy = DispatchProxy.Create<I@(domainObj)Logic, Proxy<I@(domainObj)Logic>>();
            ((Proxy<I@(domainObj)Logic>)proxy).Initialize();
            ((Proxy<I@(domainObj)Logic>)proxy).Target = @(domainVar);
            ((Proxy<I@(domainObj)Logic>)proxy).DomainObj = "@(domainObj)";

            return proxy;
        }

        /// <summary>
        /// Selects all domain objects using the default return type of the domain object.
        /// </summary>
        /// <returns>List of <see cref="@(domainObj)"/> instances.</returns>
        public  List<@(domainObj)> select()
        {
            return select<@(domainObj)>();
        }

       
    
        /// <summary>
        /// Selects all domain objects and maps them to the specified base object type.
        /// </summary>
        /// <typeparam name="TBaseObject">The type to which the results will be mapped. Must inherit from <see cref="BaseObject"/> and have a parameterless constructor.</typeparam>
        /// <returns>List of <typeparamref name="TBaseObject"/> instances.</returns>
        public  List<TBaseObject> select<TBaseObject>() where TBaseObject : BaseObject, new()
        {
            Logger.Debug("Processing @(domainObj)Logic select<TBaseObject> List");

            List<TBaseObject> @(domainVar)s = select<TBaseObject>("@(schemaName).@(tableName)-select");

            
            return @(domainVar)s;
        }

        /// <summary>
        /// Selects domain objects using a named query and maps them to the specified base object type.
        /// </summary>
        /// <typeparam name="TBaseObject">The type to which the results will be mapped. Must inherit from <see cref="BaseObject"/> and have a parameterless constructor.</typeparam>
        /// <param name="queryName">The named query to execute.</param>
        /// <returns>List of <typeparamref name="TBaseObject"/> instances.</returns>
        public List<TBaseObject> select<TBaseObject>(string queryName) where TBaseObject : BaseObject, new()
        {
            Logger.Debug($"Processing @(domainObj)Logic select<TBaseObject> with query: {queryName}");

            List<TBaseObject> @(domainVar)s = DBPersist.ExecuteQueryByName<TBaseObject>(queryName);

            return @(domainVar)s;
        }

       
        
        /// <summary>
        /// Retrieves the history records for a domain object by id.
        /// </summary>
        /// <param name="id">The id of the domain object to retrieve history for.</param>
        /// <returns>List of <see cref="@(domainObj)History"/> entries associated with the given id.</returns>
        public  List<@(domainObj)History> history(long id)
        {
            List<@(domainObj)History> @(domainVar)History = DBPersist.ExecuteQueryByName<@(domainObj)History>("@(schemaName).@(tableName)-get-history", new BaseObject() { { "id", id } });

            return @(domainVar)History;
        }
        

        /// <summary>
        /// Retrieves child records for a given domain object id and child suffix.
        /// </summary>
        /// <typeparam name="TBaseObject">The type to map child records to.</typeparam>
        /// <param name="id">The parent object's id.</param>
        /// <param name="childSuffix">The suffix identifying which child query to run.</param>
        /// <returns>List of child records mapped to <typeparamref name="TBaseObject"/>.</returns>
        public List<TBaseObject> children<TBaseObject>(long id, string childSuffix) where TBaseObject : BaseObject, new()
        {
            Logger.Debug($"Processing @(domainObj)Logic children<TBaseObject> for ID={id}, childSuffix={childSuffix}");

            string queryName = "@(schemaName).@(tableName)-children-" + childSuffix;
            List<TBaseObject> children = DBPersist.ExecuteQueryByName<TBaseObject>(queryName, new BaseObject() { { "id", id } });

            return children;
        }
        
        /// <summary>
        /// Retrieves a single domain object by id.
        /// </summary>
        /// <param name="id">The id of the domain object to retrieve.</param>
        /// <returns>An instance of <see cref="@(domainObj)"/> if found; otherwise <c>null</c>.</returns>
        public  @(domainObj) get(long id)
        {
            Logger.Debug($"Processing @(domainObj)Logic get ID={id}");

            @(domainObj) @(domainVar) = DBPersist.select<@(domainObj)>($"SELECT * FROM @(schemaName).@(tableName) WHERE id = {id}").FirstOrDefault();
            

            return @(domainVar);
        }

        /// <summary>
        /// Retrieves a view representation of the domain object by id.  A view instance contains dereferenced fields from related domain objects.
        /// </summary>
        /// <param name="id">The id of the domain object to retrieve the view for.</param>
        /// <returns>A view instance for the domain object, or <c>null</c> if not found.</returns>
        public @(domainObj)View view(long id) 
        {
            Logger.Debug($"Processing @(domainObj)Logic view<TBaseObject> ID={id}");

            string queryName = "@(schemaName).@(tableName)-get";
            List<@(domainObj)View> @(domainObj)View = DBPersist.ExecuteQueryByName<@(domainObj)View>(queryName, new BaseObject() { { "id", id } });
            

            return @(domainObj)View.FirstOrDefault();
        }
        /// <summary>
        /// Inserts a new domain object into persistence.
        /// </summary>
        /// <param name="@(domainVar)">The domain object instance to insert.</param>
        public  void insert(@(domainObj) @(domainVar))
        {
            Logger.Debug($"Processing @(domainObj)Logic insert: {@(domainVar)}");

            @(domainVar).is_active = 1;

            DBPersist.insert(@(domainVar));
        }

        /// <summary>
        /// Inserts or updates (put) the domain object in persistence.
        /// </summary>
        /// <param name="@(domainVar)">The domain object instance to put.</param>
        public  void put(@(domainObj) @(domainVar))
        {
            Logger.Debug($"Processing @(domainObj)Logic put: {@(domainVar)}");

            @(domainVar).is_active = 1;

            DBPersist.put(@(domainVar));
        }

        /// <summary>
        /// Updates an existing domain object by id using the provided instance.
        /// </summary>
        /// <param name="id">The id of the domain object to update.</param>
        /// <param name="@(domainVar)">The updated domain object instance.</param>
        public  void update(long id, @(domainObj) @(domainVar))
        {
            Logger.Debug($"Processing @(domainObj)Logic update: ID = {id}\n{@(domainVar)}");

            @(domainVar).id = id;
            DBPersist.update(@(domainVar));
        }

        /// <summary>
        /// Soft-deletes a domain object by setting its <c>is_active</c> flag to 0.
        /// </summary>
        /// <param name="id">The id of the domain object to delete.</param>
        public  void delete(long id)
        {
            @(domainObj) @(domainVar) = get(id);
            @(domainVar).is_active = 0;
            DBPersist.update(@(domainVar));
        }
        
    }
}
